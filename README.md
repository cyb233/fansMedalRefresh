# B ç«™ç²‰ä¸ç‰Œç‚¹äº®åŠ©æ‰‹

> ğŸ¯ è‡ªåŠ¨ç‚¹äº® B ç«™ç²‰ä¸ç‰Œï¼Œæ”¯æŒå¼¹å¹•ä¸ç‚¹èµä¸¤ç§æ–¹å¼ï¼Œå¯å¤šç”¨æˆ·è¿è¡Œå¹¶æ”¯æŒå¤šå¹³å°æ¨é€ã€‚

- [x] å…è®¸é…ç½®å¤šä¸ªç”¨æˆ·
- [x] ä»…æœªå¼€æ’­æ—¶å¼¹å¹•ç‚¹äº®ï¼Œå¼€æ’­åé‡‡ç”¨ç‚¹èµç‚¹äº®ï¼Œé¿å…å½±å“ä¸»æ’­
- [x] å¤šå¹³å°æ¨é€æ”¯æŒï¼Œå…·ä½“å‚è€ƒ[onepush](https://github.com/y1ndan/onepush)
- [x] è§‚çœ‹ç›´æ’­ä»»åŠ¡ï¼ˆæµ‹è¯•æ€§ï¼ŒæœªéªŒè¯åŠŸèƒ½æœ‰æ•ˆæ€§ï¼Œä¸è¿‡ 30 äº²å¯†åº¦å¤ªå°‘äº†æ„ä¹‰ä¸å¤§ï¼‰.
  - [ ] å…³é—­ç‚¹èµå’Œå¼¹å¹•æ—¶æ˜¯å¦è½¬ç§»ä¸ºè§‚çœ‹ç›´æ’­ç‚¹äº®ç²‰ä¸ç‰Œ

# ä½¿ç”¨è¯´æ˜

1. ä½¿ç”¨[Git](https://git-scm.com/downloads)å…‹éš†æˆ–ç›´æ¥[ä¸‹è½½](https://github.com/cyb233/fansMedalRefresh/archive/refs/heads/main.zip)æœ¬é¡¹ç›®

   ```bash
   git clone https://github.com/cyb233/fansMedalRefresh.git
   ```

2. å®‰è£…[Python](https://www.python.org/downloads/)ï¼ˆå»ºè®® 3.xï¼Œæœªåœ¨ 2.x ä¸­è¿›è¡Œè¿‡æµ‹è¯•ï¼‰
3. å¤åˆ¶é…ç½®æ–‡ä»¶ç¤ºä¾‹`config.example.json`å¹¶é‡å‘½åä¸º`config.json`
4. æ ¹æ®[é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)æ­£ç¡®ä¿®æ”¹`config.json`
5. å®‰è£…ä¾èµ–

   ```bash
   pip install -r requirements.txt
   ```

6. è¿è¡Œé¡¹ç›®

   ```bash
   python main.py
   ```

7. å¦‚éœ€å®šæ—¶è¿è¡Œï¼Œè¯·é€‰æ‹©ï¼š
   > é€šå¸¸å»ºè®®è¿è¡Œé—´éš”ä¸º 24 å°æ—¶ï¼Œå› ä¸ºè„šæœ¬è®¾è®¡è‡³å¤šè¿è¡Œ 24 å°æ—¶
   - **Windows**ï¼šä»»åŠ¡è®¡åˆ’ç¨‹åº
   - **Linux / macOS**ï¼š`cron` å®šæ—¶ä»»åŠ¡ç­‰

# é…ç½®è¯´æ˜

- é™¤ users å’Œ push å¤–ï¼Œå„é…ç½®é¡¹å‡æœ‰é»˜è®¤å€¼ï¼Œæ— éœ€æ”¹åŠ¨æ—¶å¯ä»¥ä¸è¿›è¡Œé…ç½®
- é…ç½®æ—¶å¯å‚è€ƒ`config.example.json`

## log â€” æ—¥å¿—é…ç½®

| å­—æ®µ      | ç±»å‹   | é»˜è®¤å€¼                                         | è¯´æ˜                                                                                                                                                                                                                                                                                                               |
| --------- | ------ | ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `enabled` | `bool` | `true`                                         | æ˜¯å¦å¯ç”¨æ—¥å¿—æ–‡ä»¶è¾“å‡º                                                                                                                                                                                                                                                                                               |
| `level`   | `str`  | `"INFO"`                                       | æ—¥å¿—çº§åˆ«ï¼Œå¯é€‰ï¼š`TRACE` / `DEBUG` / `INFO` / `SUCCESS` / `WARNING` / `ERROR` / `CRITICAL`                                                                                                                                                                                                                          |
| `file`    | `str`  | `"log/fansMedalRefresh_{time:YYYY-MM-DD}.log"` | æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œå¯ä½¿ç”¨ `{time:YYYY-MM-DD}` è‡ªåŠ¨ç”Ÿæˆæ—¥æœŸæ–‡ä»¶åï¼Œæ›´å¤šå¯ç”¨å‚æ•°å‚è€ƒ[`Loguru`æ–‡æ¡£](https://loguru.readthedocs.io/en/stable/api/logger.html#loguru._logger.Logger.add#:~:text=The%20record%20is%20just%20a%20Python%20dict,See%20datetime.datetime)ï¼Œå»ºè®®ä¿ç•™`{time:YYYY-MM-DD}`ä»¥ä¾¿é…åˆé»˜è®¤ä¿ç•™ 30 å¤©æ—¥å¿— |

**è¯´æ˜ï¼š**

- å¯ç”¨åç¨‹åºè¿è¡Œæ—¥å¿—å°†å†™å…¥æ–‡ä»¶ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜ä¸è®°å½•ä»»åŠ¡æ‰§è¡Œæƒ…å†µ
- æ—¥å¿—æ–‡ä»¶è·¯å¾„`file`å»ºè®®ä¿ç•™`{time:YYYY-MM-DD}`æ¨¡æ¿ï¼Œä»¥ç¡®ä¿ä»…ä¿ç•™æœ€è¿‘ 30 å¤©æ—¥å¿—çš„åŠŸèƒ½æ­£å¸¸è¿è¡Œ

**_âš ï¸ ä¸ºäº†æ‚¨çš„è´¦å·å®‰å…¨ï¼Œå¦‚éœ€æäº¤æ—¥å¿—ï¼Œè¯·æ³¨æ„è‡ªè¡Œå¯¹æ—¥å¿—éšç§å†…å®¹æ‰“ç ï¼ˆå¦‚`Cookie`ç­‰ï¼‰ï¼ä¸”é€šå¸¸å»ºè®®æäº¤`DEBUG`æˆ–`TRACE`çº§åˆ«æ—¥å¿—_**

---

## users â€” ç”¨æˆ·é…ç½®åˆ—è¡¨ï¼ˆå¿…å¡«ï¼‰

ç”¨äºå­˜æ”¾æ¯ä¸ªè´¦å·çš„ç™»å½•ä¿¡æ¯ä¸ç™½/é»‘åå•è®¾ç½®ï¼Œ**è‡³å°‘éœ€è¦ä¸€ä¸ªç”¨æˆ·é…ç½®**ã€‚

| å­—æ®µ         | ç±»å‹        | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜                                 |
| ------------ | ----------- | ---- | ------ | ------------------------------------ |
| `cookie`     | `str`       | âœ…   | æ—      | ç”¨æˆ·çš„ B ç«™ç™»å½• Cookieï¼Œç”¨äºæ¥å£éªŒè¯ |
| `white_uids` | `List[int]` |      | `[]`   | ç™½åå• UIDï¼Œä»…è¿™äº›ç”¨æˆ·ä¼šè¢«æ“ä½œ       |
| `black_uids` | `List[int]` |      | `[]`   | é»‘åå• UIDï¼Œè¿™äº›ç”¨æˆ·ä¼šè¢«è·³è¿‡         |

**è¯´æ˜ï¼š**

- `cookie` ä¸èƒ½ä¸ºç©ºï¼Œå¦åˆ™ä¼šè§¦å‘é…ç½®é”™è¯¯
- ä½ å¯ä»¥é€šè¿‡åœ¨å·²ç™»é™†çš„ B ç«™ä¸»ç«™é¡µé¢çš„åœ°å€æ è¾“å…¥ä»¥ä¸‹ js æ¥è·å–å¹¶è‡ªè¡Œå¤åˆ¶ cookieï¼Œæ³¨æ„ Chrome ç­‰æµè§ˆå™¨å¯èƒ½å› å®‰å…¨åŸå› è‡ªåŠ¨åˆ é™¤å¼€å¤´çš„`javascript:`

  ```
  javascript: (() => {prompt("å½“å‰é¡µé¢çš„ Cookieï¼š", document.cookie || '');})();
  ```

  > ä¹Ÿå¯é€šè¿‡ä¹¦ç­¾ç®¡ç†å™¨å°†ä»¥ä¸Šä»£ç æ·»åŠ åˆ°ä¹¦ç­¾æ¥å¿«é€Ÿä½¿ç”¨ï¼Œåªéœ€åœ¨ç›¸åº”é¡µé¢ç‚¹å‡»æ­¤ä¹¦ç­¾å³å¯

---

## like â€” ç‚¹èµé…ç½®

| å­—æ®µ         | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                 |
| ------------ | ------ | ------ | -------------------- |
| `enabled`    | `bool` | `true` | æ˜¯å¦å¯ç”¨è‡ªåŠ¨ç‚¹èµåŠŸèƒ½ |
| `like_count` | `int`  | `30`   | æ¯æ¬¡ç‚¹èµæ•°é‡         |

**è¯´æ˜ï¼š**

- è‹¥å…³é—­ (`enabled=false`)ï¼Œç¨‹åºå°†è·³è¿‡ç‚¹èµä»»åŠ¡

---

## danmaku â€” å¼¹å¹•é…ç½®

| å­—æ®µ            | ç±»å‹        | é»˜è®¤å€¼               | è¯´æ˜                     |
| --------------- | ----------- | -------------------- | ------------------------ |
| `enabled`       | `bool`      | `true`               | æ˜¯å¦å¯ç”¨è‡ªåŠ¨å¼¹å¹•å‘é€     |
| `min_interval`  | `int`       | `5`                  | æœ€å°å¼¹å¹•å‘é€é—´éš”ï¼ˆç§’ï¼‰   |
| `max_interval`  | `int`       | `10`                 | æœ€å¤§å¼¹å¹•å‘é€é—´éš”ï¼ˆç§’ï¼‰   |
| `danmaku_count` | `int`       | `10`                 | æ¯æ¬¡å‘é€å¼¹å¹•æ•°é‡         |
| `danmaku_list`  | `List[str]` | é»˜è®¤æä¾› 15 æ¡é¢œæ–‡å­— | å¼¹å¹•æ–‡æœ¬åˆ—è¡¨ï¼ˆéšæœºå‘é€ï¼‰ |

**è¯´æ˜ï¼š**

- è‹¥å…³é—­ (`enabled=false`)ï¼Œç¨‹åºå°†è·³è¿‡å¼¹å¹•ä»»åŠ¡
- å¯è‡ªç”±è‡ªå®šä¹‰å¼¹å¹•å†…å®¹ï¼ˆè¡¨æƒ…ã€ç¥ç¦è¯­ç­‰ï¼‰
- å¼¹å¹•å†…å®¹ä¸ºçº¯æ–‡æœ¬ï¼Œå»ºè®®æ§åˆ¶é•¿åº¦

---

## live â€” è§‚çœ‹é…ç½®

| å­—æ®µ                 | ç±»å‹   | é»˜è®¤å€¼ | è¯´æ˜                                         |
| -------------------- | ------ | ------ | -------------------------------------------- |
| `enabled`            | `bool` | `true` | æ˜¯å¦å¯ç”¨è‡ªåŠ¨è§‚çœ‹åŠŸèƒ½                         |
| `policy`             | `int`  | `1`    | è§‚çœ‹ç­–ç•¥ï¼š`1`=ä»…ç‚¹äº®ç‰Œå­ï¼Œ`2`=å®Œæ•´è§‚çœ‹äº²å¯†åº¦ |
| `light_time`         | `int`  | `15`   | ç‚¹äº®æ‰€éœ€è§‚çœ‹æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰                     |
| `full_affinity_time` | `int`  | `25`   | å®Œæ•´è§‚çœ‹äº²å¯†åº¦æ‰€éœ€æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰               |

**è¯´æ˜ï¼š**

- è‹¥å…³é—­ (`enabled=false`)ï¼Œç¨‹åºå°†è·³è¿‡å¼¹å¹•ä»»åŠ¡
- `policy=1`ï¼šä»…ç‚¹äº®ç²‰ä¸ç‰Œï¼Œæ—¶é—´çŸ­
- `policy=2`ï¼šå®Œæ•´è§‚çœ‹æå‡äº²å¯†åº¦ï¼Œæ—¶é—´æ›´é•¿
  > æ³¨æ„ï¼šè„šæœ¬é»˜è®¤å•æ¬¡è¿è¡Œæœ€å¤š 24 å°æ—¶ï¼Œå½“å‰é»˜è®¤é…ç½®ç†è®ºè‡³å¤šæ‰§è¡Œ 24\*60/25=57.6 å³ 57 ä¸ªç²‰ä¸ç‰Œçš„å®Œæ•´äº²å¯†åº¦ï¼Œæˆ–ç†è®ºç‚¹äº®è‡³å¤š 24\*60/15=96 ä¸ªç²‰ä¸ç‰Œ

---

## push â€” æ¨é€é…ç½®åˆ—è¡¨

æ”¯æŒå¤šä¸ªæ¨é€é€šé“ï¼ˆå¦‚ Telegramã€Discordã€WechatWorkã€Larkã€DingTalkã€PushPlus ç­‰ï¼‰ï¼Œå…·ä½“è¯·å‚è€ƒ[onepush](https://github.com/y1ndan/onepush)ã€‚

| å­—æ®µ            | ç±»å‹   | é»˜è®¤å€¼  | è¯´æ˜                                                                                         |
| --------------- | ------ | ------- | -------------------------------------------------------------------------------------------- |
| `provider_name` | `str`  | æ—       | æ¨é€æœåŠ¡æä¾›å•†åç§°ï¼ˆå¿…å¡«ï¼‰                                                                   |
| `proxies`       | `dict` | `null`  | ç½‘ç»œä»£ç†è®¾ç½®ï¼Œå¦‚ `{'http': 'socks5h://127.0.0.1:1080', 'https': 'socks5h://127.0.0.1:1080'}` |
| `use_markdown`  | `bool` | `false` | æ˜¯å¦å¯ç”¨ Markdown æ ¼å¼æ¶ˆæ¯ï¼Œå¯ç”¨åä¼šå¯¹å¸¸è§ Markdown å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œé¿å…å‡ºé”™                   |
| å…¶ä»–å­—æ®µ        | `ä»»æ„` | æ—       | æ¨é€æœåŠ¡ç‰¹å®šå‚æ•°ï¼Œå¦‚ `token`ã€`userid`ã€`key` ç­‰ï¼Œå…·ä½“è¯·å‚è€ƒå„é€šé“æ–‡æ¡£                       |

**ç¤ºä¾‹ï¼šTelegram æ¨é€**

```json
[
  {
    "provider_name": "telegram",
    "proxies": {
      "http": "socks5h://127.0.0.1:1080",
      "https": "socks5h://127.0.0.1:1080"
    },
    "use_markdown": true,
    "token": "your_token",
    "userid": "your_userid"
  }
]
```

# å‚è€ƒé¡¹ç›®

[fansMedalHelper](https://github.com/XiaoMiku01/fansMedalHelper) â€” æœ¬é¡¹ç›®çš„çµæ„Ÿæ¥æºä¸å‚è€ƒå®ç°
